(()=>{"use strict";let e=null;function t(e){if(!e)return!1;if(e.isContentEditable)return!0;if("TEXTAREA"===e.tagName)return!0;if("INPUT"===e.tagName){const t=e.type.toLowerCase();return["text","search","url","email","password","tel"].includes(t)}return!1}function n(e){return e.split(/(\s+)/).filter(e=>e.length>0)}function o(){e=null}function s(s,i){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=document.activeElement;if(!t(a))return void console.warn("Active element cannot accept text input");const c=n(s||"This is a test of human-like typing. ");let u=0;function l(){if(u>=c.length||e!==i)return;const n=c[u];try{if(document.activeElement!==a||!t(a))return console.warn("Active element changed during typing session"),void o();let s;!function(e,t){if(e.isContentEditable){if(document.queryCommandSupported&&document.queryCommandSupported("insertText")&&document.execCommand("insertText",!1,t)){const n=new InputEvent("input",{bubbles:!0,cancelable:!0,inputType:"insertText",data:t});return void e.dispatchEvent(n)}const n=window.getSelection();if(n.rangeCount>0){const o=n.getRangeAt(0);o.deleteContents(),o.insertNode(document.createTextNode(t)),o.collapse(!1),n.removeAllRanges(),n.addRange(o);const s=new InputEvent("input",{bubbles:!0,cancelable:!0,inputType:"insertText",data:t});e.dispatchEvent(s)}}else if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const n=e.selectionStart||0,o=e.selectionEnd||0,s=e.value||"";e.value=s.substring(0,n)+t+s.substring(o,s.length);const i=n+t.length;e.setSelectionRange(i,i);const r=new InputEvent("input",{bubbles:!0,cancelable:!0,inputType:"insertText",data:t});e.dispatchEvent(r);const a=new Event("change",{bubbles:!0});e.dispatchEvent(a)}}(a,n),u++,s=/^\s+$/.test(n)?200*Math.random()+100:600*Math.random()+200,e===i&&u<c.length?setTimeout(l,s):u>=c.length&&o()}catch(e){console.error("Error during typing:",e),o()}}e=i,r?setTimeout(l,1e3):l()}chrome.runtime.onMessage.addListener((e,t,n)=>{try{if("startTyping"===e.action){if(!e.text||"string"!=typeof e.text)return void n({success:!1,error:"Invalid text provided"});const t=Date.now()+Math.random();s(e.text,t,Boolean(e.delayedStart)),n({success:!0,sessionId:t})}else"stopTyping"===e.action?(o(),n({success:!0})):n({success:!1,error:"Unknown action"})}catch(e){console.error("Error handling message:",e),n({success:!1,error:e.message})}return!0}),window.addEventListener("beforeunload",o),window.addEventListener("pagehide",o),"undefined"!=typeof module&&module.exports&&(module.exports={emulateTyping:s,canAcceptText:t,splitTextIntoChunks:n,cleanup:o})})();
//# sourceMappingURL=content.js.map